<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Homecrew - Boodschappen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>

/* ALGEMEEN */
* {
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
}

body {
    background: #ecf0f1;
}

.app-body {
    padding-bottom: 60px;
}

/* TOPBAR */
.topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #2c3e50;
    padding: 10px;
    color: white;
}

.home-btn {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
}

.home-btn:hover {
    opacity: 0.7;
}

/* CONTENT */
.content {
    padding: 15px;
}

h3 {
    margin: 10px 0 20px 0;
}

/* CARD */
.card {
    background: white;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

/* KNOPPEN BOVEN */
.dashboard-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.dash-btn {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #3498db;
    color: white;
    padding: 12px;
    border-radius: 10px;
    cursor: pointer;
}

.dash-btn:hover {
    background: #2980b9;
}

.list-box {
    display: none;
    margin-top: 15px;
}

.list-box.show {
    display: block;
}

/* INPUT */
.input-group {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.input-group input {
    flex: 1;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 15px;
}

.input-group button {
    width: 45px;
    border: none;
    background: #2ecc71;
    color: white;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
}

.input-group button:hover {
    background: #27ae60;
}

/* âœ… HET BELANGRIJKSTE: LIJSTSTYLE */
ul {
    list-style: none;
    padding: 0;
}

li {
    display: flex;
    align-items: center;
    justify-content: space-between;

    background: #f7f9fa;
    padding: 10px 12px;
    margin-bottom: 8px;
    border-radius: 10px;

    transition: 0.2s ease;
}

li:hover {
    background: #e8f4fc;
}

li span {
    flex: 1;
    font-size: 15px;
    padding-right: 10px;
}

/* DELETE BUTTON */
li button {
    min-width: 40px;
    height: 40px;

    border-radius: 50%;
    border: none;
    background: #e74c3c;
    color: white;

    display: flex;
    align-items: center;
    justify-content: center;

    cursor: pointer;
    transition: 0.2s ease;
}

li button:hover {
    background: #c0392b;
}

</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCwlr069pxNXEEhIEGNug5Ly_kKSuvxSzs",
  authDomain: "homecrew-d8e21.firebaseapp.com",
  databaseURL: "https://homecrew-d8e21-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "homecrew-d8e21",
  storageBucket: "homecrew-d8e21.firebasestorage.app",
  messagingSenderId: "47664248188",
  appId: "1:47664248188:web:0994c6b2ba07f6fee060f9"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* USER CHECK */
const user = localStorage.getItem("homecrewUser") || sessionStorage.getItem("homecrewUser");
if(!user) window.location.href = "index.html";

document.addEventListener("DOMContentLoaded", ()=>{
    document.getElementById("welcomeUser").innerText = "Welkom, " + user + " ðŸ‘‹";
})

/* LIVE LOAD */
function liveLoad(place){
    const listRef = ref(db, "boodschappen/" + place);

    onValue(listRef, (snapshot)=>{
        const ul = document.getElementById(place + "List");
        ul.innerHTML = "";

        if(snapshot.exists()){
            const data = snapshot.val();

            Object.keys(data).forEach(key=>{
                const li = document.createElement("li");

                const text = document.createElement("span");
                text.textContent = data[key].item;

                const del = document.createElement("button");
                del.innerHTML = `<i class="fas fa-trash"></i>`;
                del.onclick = ()=> removeItem(place,key);

                li.appendChild(text);
                li.appendChild(del);
                ul.appendChild(li);
            });
        }
    })
}

/* ADD */
window.addItem = function(place){
    const input = document.getElementById(place + "Input");
    const value = input.value.trim();
    if(!value) return;

    const listRef = ref(db, "boodschappen/" + place);
    push(listRef, {
        item: value,
        user: user,
        time: Date.now()
    });

    input.value = "";
}

/* REMOVE */
function removeItem(place,key){
    const itemRef = ref(db, "boodschappen/" + place + "/" + key);
    remove(itemRef);
}

/* LOGOUT */
window.logout = function(){
  localStorage.clear();
  sessionStorage.clear();
  window.location.href = "index.html";
}

/* START */
liveLoad("vingardium");
liveLoad("drijvelden");

</script>
</head>

<body class="app-body">

<header class="topbar">
  <button onclick="window.location.href='dashboard.html'" class="home-btn">
    <i class="fas fa-home"></i>
  </button>

  <h2>ðŸ›’ Boodschappen</h2>

  <button onclick="logout()" class="home-btn">
    <i class="fas fa-sign-out-alt"></i>
  </button>
</header>

<main class="content">

<h3 id="welcomeUser"></h3>

<div class="card">

  <div class="dashboard-buttons">

    <div class="dash-btn" onclick="document.getElementById('vingardium-box').classList.toggle('show')">
      <i class="fas fa-seedling"></i> Vingardium <i class="fas fa-chevron-down"></i>
    </div>

    <div class="dash-btn" onclick="document.getElementById('drijvelden-box').classList.toggle('show')">
      <i class="fas fa-tractor"></i> Drijvelden <i class="fas fa-chevron-down"></i>
    </div>
  </div>

  <div class="list-box show" id="vingardium-box">
    <div class="input-group">
      <input type="text" id="vingardiumInput" placeholder="Nieuw item...">
      <button onclick="addItem('vingardium')"><i class="fas fa-plus"></i></button>
    </div>
    <ul id="vingardiumList"></ul>
  </div>

  <div class="list-box show" id="drijvelden-box">
    <div class="input-group">
      <input type="text" id="drijveldenInput" placeholder="Nieuw item...">
      <button onclick="addItem('drijvelden')"><i class="fas fa-plus"></i></button>
    </div>
    <ul id="drijveldenList"></ul>
  </div>

</div>
</main>
</body>
</html>
