<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Homecrew - Boodschappen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f3f6f9;
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

.app-body {
    padding: 12px;
}

.topbar {
    background: #2c3e50;
    color: white;
    padding: 14px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.home-btn {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
}

.content {
    margin-top: 10px;
}

/* ALGEMEEN */
.card {
    display: flex;
    flex-direction: column;
    gap: 26px;
}

/* DASH BUTTONS PER HUIS */
.dashboard-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.dash-btn {
    padding: 14px;
    border-radius: 12px;
    color: white;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
}

/* HUIS-KLEUREN */
.vingardium-btn {
    background: linear-gradient(135deg, #27ae60, #1e8449);
}

.drijvelden-btn {
    background: linear-gradient(135deg, #f39c12, #d35400);
}

/* LIJST BOX */
.list-box {
    display: none;
    background: white;
    padding: 14px;
    border-radius: 16px;
}

.list-box.show {
    display: block;
}

/* EXTRA ONDERSCHEID */
.vingardium-box {
    border-left: 8px solid #27ae60;
    background: #ecfdf5;
}

.drijvelden-box {
    border-left: 8px solid #f39c12;
    background: #fff5e6;
}

/* TITEL */
.house-title {
    padding: 10px;
    margin-bottom: 12px;
    border-radius: 10px;
    font-weight: bold;
    color: white;
    display: flex;
    align-items: center;
    gap: 8px;
}

.vingardium-title {
    background: #27ae60;
}

.drijvelden-title {
    background: #f39c12;
}

/* INPUT */
.input-group {
    display: flex;
    margin-bottom: 10px;
}

.input-group input {
    flex: 1;
    padding: 10px;
    border-radius: 10px 0 0 10px;
    border: none;
    outline: none;
}

.input-group button {
    width: 55px;
    border: none;
    border-radius: 0 10px 10px 0;
    background: linear-gradient(135deg, #2980b9, #3498db);
    color: white;
    font-size: 18px;
}

/* LIJST ITEMS */
ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

li {
    padding: 10px 12px;
    margin-bottom: 8px;
    background: white;
    border-radius: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* NETTE VERHOUDING TEKST / ICOON */
li span {
    flex: 1;
    text-align: left;
    font-size: 15px;
}

li button {
    background: #e74c3c;
    border: none;
    color: white;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    font-size: 14px;
}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCwlr069pxNXEEhIEGNug5Ly_kKSuvxSzs",
  authDomain: "homecrew-d8e21.firebaseapp.com",
  databaseURL: "https://homecrew-d8e21-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "homecrew-d8e21",
  storageBucket: "homecrew-d8e21.firebasestorage.app",
  messagingSenderId: "47664248188",
  appId: "1:47664248188:web:0994c6b2ba07f6fee060f9"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const user = localStorage.getItem("homecrewUser") || sessionStorage.getItem("homecrewUser");
if(!user) window.location.href = "index.html";

document.addEventListener("DOMContentLoaded", ()=>{
  document.getElementById("welcomeUser").innerText = "Welkom, " + user + " ðŸ‘‹";
})

function liveLoad(place){
  const listRef = ref(db, "boodschappen/" + place);

  onValue(listRef, (snapshot)=>{
    const ul = document.getElementById(place + "List");
    ul.innerHTML = "";

    if(snapshot.exists()){
      const data = snapshot.val();

      Object.keys(data).forEach(key=>{
        const li = document.createElement("li");

        const text = document.createElement("span");
        text.textContent = data[key].item;

        const del = document.createElement("button");
        del.innerHTML = `<i class="fas fa-trash"></i>`;
        del.onclick = ()=> removeItem(place,key);

        li.appendChild(text);
        li.appendChild(del);
        ul.appendChild(li);
      });
    }
  })
}

window.addItem = function(place){
  const input = document.getElementById(place + "Input");
  const value = input.value.trim();
  if(!value) return;

  const listRef = ref(db, "boodschappen/" + place);
  push(listRef, {
    item: value,
    user: user,
    time: Date.now()
  });

  input.value = "";
}

function removeItem(place,key){
  const itemRef = ref(db, "boodschappen/" + place + "/" + key);
  remove(itemRef);
}

window.logout = function(){
  localStorage.clear();
  sessionStorage.clear();
  window.location.href = "index.html";
}

liveLoad("vingardium");
liveLoad("drijvelden");
</script>
</head>

<body class="app-body">

<header class="topbar">
  <button onclick="window.location.href='dashboard.html'" class="home-btn">
    <i class="fas fa-home"></i>
  </button>

  <h2>ðŸ›’ Boodschappen</h2>

  <button onclick="logout()" class="home-btn">
    <i class="fas fa-sign-out-alt"></i>
  </button>
</header>

<main class="content">

<h3 id="welcomeUser"></h3>

<div class="card">

<div class="dashboard-buttons">

    <div class="dash-btn vingardium-btn" onclick="document.getElementById('vingardium-box').classList.toggle('show')">
      <div><i class="fas fa-seedling"></i> VINGARDIUM</div>
      <i class="fas fa-chevron-down"></i>
    </div>

    <div class="dash-btn drijvelden-btn" onclick="document.getElementById('drijvelden-box').classList.toggle('show')">
      <div><i class="fas fa-tractor"></i> DRIJVELDEN</div>
      <i class="fas fa-chevron-down"></i>
    </div>

</div>

<div class="list-box show vingardium-box" id="vingardium-box">

  <div class="house-title vingardium-title">
    <i class="fas fa-seedling"></i> Boodschappen voor Vingardium
  </div>

  <div class="input-group">
    <input type="text" id="vingardiumInput" placeholder="Nieuw item voor Vingardium...">
    <button onclick="addItem('vingardium')"><i class="fas fa-plus"></i></button>
  </div>

  <ul id="vingardiumList"></ul>
</div>

<div class="list-box show drijvelden-box" id="drijvelden-box">

  <div class="house-title drijvelden-title">
    <i class="fas fa-tractor"></i> Boodschappen voor Drijvelden
  </div>

  <div class="input-group">
    <input type="text" id="drijveldenInput" placeholder="Nieuw item voor Drijvelden...">
    <button onclick="addItem('drijvelden')"><i class="fas fa-plus"></i></button>
  </div>

  <ul id="drijveldenList"></ul>
</div>

</div>
</main>

</body>
</html>
