<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Homecrew - Berichten</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="manifest" href="/Homecrew/manifest.json">
    <meta name="theme-color" content="#3a6ea5">
    <link rel="apple-touch-icon" href="/Homecrew/icons/icon-192.png">

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/Homecrew/style.css">
</head>

<body>

<div class="dashboard-container">

    <div class="welcome-banner">
        <h1 id="welcome"></h1>
        <p>Interne berichten ðŸ“©</p>
    </div>

    <div class="chat-box" id="chatBox"></div>

    <div class="chat-input">
        <input type="text" id="messageInput" placeholder="Typ een bericht...">
        <button onclick="sendMessage()">ðŸ“¤</button>
    </div>

    <button class="dash-btn" onclick="window.location.href='/Homecrew/dashboard.html'">
        <i class="fas fa-home"></i>
        <span>Dashboard</span>
    </button>

</div>

<script>
const activeUser = localStorage.getItem("homecrewUser");
if (!activeUser) window.location.href = "/Homecrew/index.html";

document.getElementById("welcome").innerText = "Welkom, " + activeUser + " ðŸ‘‹";

function loadMessages() {
  const messages = JSON.parse(localStorage.getItem("homecrew_messages")) || [];
  const box = document.getElementById("chatBox");
  box.innerHTML = "";

  messages.forEach(msg => {
    const div = document.createElement("div");
    div.className = msg.user === activeUser ? "my-message" : "other-message";
    div.innerHTML = `<strong>${msg.user}:</strong> ${msg.text}`;
    box.appendChild(div);
  });

  box.scrollTop = box.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("messageInput");
  const text = input.value.trim();
  if (!text) return;

  const messages = JSON.parse(localStorage.getItem("homecrew_messages")) || [];
  messages.push({
    user: activeUser,
    text: text,
    time: Date.now()
  });

  localStorage.setItem("homecrew_messages", JSON.stringify(messages));
  input.value = "";
  loadMessages();
}

loadMessages();
setInterval(loadMessages, 1500);
</script>

</body>
</html>
