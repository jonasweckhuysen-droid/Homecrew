<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Homecrew - Berichten</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
</head>
<body class="app-body">

<header class="topbar">
  <button onclick="window.location.href='dashboard.html'" class="home-btn">ğŸ  Home</button>
  <h2>ğŸ’¬ Berichten</h2>
  <button onclick="logout()" class="home-btn">ğŸšª Uitloggen</button>
</header>

<main class="content">
  <h3 id="welcomeUser"></h3>

  <div class="card">
    <div id="chatBox" class="chat-box" style="max-height:300px; overflow-y:auto; padding:10px;"></div>

    <input type="text" id="messageInput" placeholder="Typ je bericht..." />
    <input type="file" id="imageInput" accept="image/*" />
    <button class="main-btn" onclick="sendMessage()">Verstuur</button>
  </div>
</main>

<script>
// ===========================
// USER CHECK
// ===========================
const user = localStorage.getItem("homecrewUser") || sessionStorage.getItem("homecrewUser");
if(!user) window.location.href = "index.html";
document.getElementById("welcomeUser").innerText = "Welkom, " + user + " ğŸ‘‹";

// Gebruikerskleuren
function getUserColor(user){
  if(user.toLowerCase() === "jonas") return "#3498db";
  if(user.toLowerCase() === "liese") return "#e74c3c";
  if(user.toLowerCase() === "loreana") return "#ff69b4";
  return "#555";
}

// ===========================
// LOGOUT
// ===========================
function logout(){
  localStorage.clear();
  sessionStorage.clear();
  location.href = "index.html";
}

// ===========================
// MESSAGES
// ===========================
function sendMessage(){
  const input = document.getElementById("messageInput");
  const text = input.value.trim();
  if(!text) return;

  let messages = JSON.parse(localStorage.getItem("homecrewMessages")) || [];
  messages.push({ user, text, time: new Date().toISOString() });
  localStorage.setItem("homecrewMessages", JSON.stringify(messages));
  input.value = "";
  loadMessages();
}

function loadMessages(){
  const chatBox = document.getElementById("chatBox");
  chatBox.innerHTML = "";
  let messages = JSON.parse(localStorage.getItem("homecrewMessages")) || [];

  messages.forEach(msg => {
    const div = document.createElement("div");
    div.style.background = getUserColor(msg.user);
    div.style.color = "white";
    div.style.padding = "8px 12px";
    div.style.borderRadius = "12px";
    div.style.marginBottom = "8px";
    div.innerHTML = `<strong>${msg.user}</strong>: ${msg.text} <small style="opacity:0.7;">${new Date(msg.time).toLocaleString("nl-BE")}</small>`;
    chatBox.appendChild(div);
  });

  chatBox.scrollTop = chatBox.scrollHeight;
}

// Initial load
loadMessages();
</script>

</body>
</html>
